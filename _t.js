function parseCSV(t){const e=[];let n="",o=!1,r=[];for(let i=0;i<t.length;i++){const a=t[i];if('"'===a)o=!o;else if(","===a&&!o)r.push(n.trim()),n="";else if(("\n"===a||"\r"===a)&&!o){if(n.length||r.length){r.push(n.trim());e.push(r)}n="";r=[];if("\r"===a&&"\n"===t[i+1])i++}else n+=a}if(n.length||r.length){r.push(n.trim());e.push(r)}if(e.length<2)return[];const h=e[0];return e.slice(1).filter(t=>t.some(e=>e)).map(t=>{const e={};h.forEach((n,o)=>{e[n]=t[o]||""});return e})}let db=[],quotesDb=[],resumeDb=[],isSearchActive=!1;const CACHE_KEY="sahib_v1_cache",CACHE_EXPIRY=36e5,CONFIG={main_sheet:"https://docs.google.com/spreadsheets/d/e/2PACX-1vT7HtdJsNwYO8TkB4mem_IKZ-D8xNZ9DTAi-jgxpDM2HScpp9Tlz5DGFuBPd9TuMRwP16vUd-5h47Yz/pub?gid=0&single=true&output=csv",quotes_sheet:"https://docs.google.com/spreadsheets/d/e/2PACX-1vT7HtdJsNwYO8TkB4mem_IKZ-D8xNZ9DTAi-jgxpDM2HScpp9Tlz5DGFuBPd9TuMRwP16vUd-5h47Yz/pub?gid=540861260&single=true&output=csv",resume_sheet:"https://docs.google.com/spreadsheets/d/e/2PACX-1vT7HtdJsNwYO8TkB4mem_IKZ-D8xNZ9DTAi-jgxpDM2HScpp9Tlz5DGFuBPd9TuMRwP16vUd-5h47Yz/pub?gid=1812444133&single=true&output=csv",custom_resume_sheet:"https://docs.google.com/spreadsheets/d/e/2PACX-1vT7HtdJsNwYO8TkB4mem_IKZ-D8xNZ9DTAi-jgxpDM2HScpp9Tlz5DGFuBPd9TuMRwP16vUd-5h47Yz/pub?gid=1529790368&single=true&output=csv"},init=()=>{if("#professional/resumec"===window.location.hash.toLowerCase()&&(console.log("Entering Custom Resume Builder Mode"),CONFIG.resume_sheet=CONFIG.custom_resume_sheet,localStorage.removeItem(CACHE_KEY)),"#demo"===window.location.hash.toLowerCase()||"#test"===window.location.hash.toLowerCase())return console.log("Entering Demo Mode"),void loadDemoData();setTimeout(()=>document.body.classList.remove("no-transition"),1e3),loadFromCache().then(e=>{const t="true"===localStorage.getItem("preview_drafts")||"localhost"===window.location.hostname;e?(db=e.main,quotesDb=e.quotes,resumeDb=e.resume||[],t||(db=db.filter(e=>!e.Tags||!e.Tags.includes("Draft")),quotesDb=quotesDb.filter(e=>!e.Tags||!e.Tags.includes("Draft"))),startApp(),fetchDataAndCache().then(()=>{t||(db=db.filter(e=>!e.Tags||!e.Tags.includes("Draft")),quotesDb=quotesDb.filter(e=>!e.Tags||!e.Tags.includes("Draft")))})):fetchDataAndCache().then(()=>{t||(db=db.filter(e=>!e.Tags||!e.Tags.includes("Draft")),quotesDb=quotesDb.filter(e=>!e.Tags||!e.Tags.includes("Draft"))),startApp()})})};function startApp(){window.location.search&&history.replaceState(null,null,window.location.pathname+window.location.hash),initApp(),updateSEO(),renderFooter(),initImageZoomers(),requestAnimationFrame(()=>{setTimeout(()=>{document.body.classList.remove("no-transition"),document.getElementById("main-header").classList.remove("no-transition"),updatePadding()},50)})}async function loadFromCache(){try{const e=localStorage.getItem(CACHE_KEY);if(!e)return null;const t=JSON.parse(e);return Date.now()-t.ts>36e5?null:t.data}catch(e){return null}}async function fetchDataAndCache(){try{const[e,t,i]=await Promise.all([fetchCSV(CONFIG.main_sheet),fetchCSV(CONFIG.quotes_sheet).catch(()=>[]),fetchCSV(CONFIG.resume_sheet).catch(()=>[])]),n=e.filter(e=>e.Title||e.Content||"Professional/Resume"===e.Page);if(!n.find(e=>"Professional/Resume"===e.Page)){const e={Title:"Resume",Page:"Professional/Resume",SectionType:"Virtual",Timestamp:""};n.push(e)}return db=n,quotesDb=t,resumeDb=i,localStorage.setItem(CACHE_KEY,JSON.stringify({ts:Date.now(),data:{main:n,quotes:t,resume:i}})),[n,t,i]}catch(e){console.error("Fetch failed",e)}}function fetchCSV(e){return fetch(e).then(r=>r.text()).then(r=>parseCSV(r))}function safeHTML(e){return"undefined"!=typeof DOMPurify?DOMPurify.sanitize(e,{ADD_TAGS:["iframe","blockquote"],ADD_ATTR:["allow","allowfullscreen","frameborder","scrolling","src","width","height","target","referrerpolicy"]}):e}const Analytics={trackView:()=>{},trackEvent:()=>{}};function initApp(){handleRouting(),window.addEventListener("hashchange",handleRouting),window.addEventListener("hashchange",function(e){Analytics.trackView(location.pathname+location.search+location.hash,location.hash.substring(1)||"Home")}),window.addEventListener("scroll",()=>{const e=document.getElementById("main-header"),t=window.scrollY>10;e.classList.toggle("scrolled",t)}),window.addEventListener("touchmove",()=>{document.getElementById("main-header").classList.add("scrolling")}),document.addEventListener("click",e=>{const t=document.getElementById("search-overlay"),i=document.getElementById("search-controls");!t.classList.contains("active")||t.contains(e.target)||i.contains(e.target)||closeSearch()}),document.getElementById("app").addEventListener("click",e=>{if(e.target.closest(".refresh-btn")){const t=e.target.closest(".layout-quote");if(t&&!t.classList.contains("loading")){const e=t.clientHeight;t.style.height=e+"px",t.classList.add("loading"),t.innerHTML='<div class="sk-box quote" style="height: 100% !important;"></div>',setTimeout(()=>{renderQuoteCard(t),t.classList.remove("loading"),t.style.height="auto"},600)}return void e.stopPropagation()}if(e.target.classList.contains("chip")){e.stopPropagation(),isSearchActive&&closeSearch();const t=e.target.getAttribute("data-tag"),i=e.target.getAttribute("data-date");return void(i?window.location.hash="Filter:"+i:t&&(window.location.hash="Filter:"+t))}if(e.target.closest(".stl-btn"))return void e.stopPropagation();const t=e.target.closest(".embed-wrapper.stl");if(t&&2===e.detail){const e=t.querySelector("#btn-full");e&&e.click()}const i=e.target.closest(".clickable-block");if(i&&!e.target.classList.contains("chip")){const e=i.getAttribute("data-link"),t=i.getAttribute("data-target");e&&("_blank"===t?window.open(e,"_blank"):(window.location.href=e,isSearchActive&&closeSearch()))}}),document.addEventListener("click",e=>{if(!e.target.closest(".zoom-frame, .row-media.article-mode")){document.querySelectorAll(".zoomed").forEach(e=>e.classList.remove("zoomed"))}}),document.addEventListener("keydown",e=>{const t="search-input"===(document.activeElement?document.activeElement.id:"");if(t){if("Backspace"===e.key&&""===document.getElementById("search-input").value)return void closeSearch();if("/"===e.key||"Escape"===e.key)return e.preventDefault(),void closeSearch()}!("/"===e.key||e.metaKey&&"k"===e.key||e.ctrlKey&&"k"===e.key)||isSearchActive||t||(e.preventDefault(),toggleSearch()),"Escape"===e.key&&(isSearchActive||document.getElementById("search-overlay").classList.contains("active")?closeSearch():window.location.hash&&"#Home"!==window.location.hash&&resetToHome())})}function initImageZoomers(){let e=null,t=0,i=0,n=0,s=0,a=0,o=0,r=!1;const l=e=>{e.style.transform=`scale(1.75) translate(${n}px, ${s}px)`},c=()=>{if(e){const t=e.querySelector("img");t&&(t.style.transition="")}e=null};document.addEventListener("mousemove",t=>{const i=t.target.closest(".zoomed");if(!i||e||r)return;const n=i.querySelector("img"),s=i.getBoundingClientRect(),a=(t.clientX-s.left)/s.width*100,o=(t.clientY-s.top)/s.height*100;n.style.transformOrigin=`${a}% ${o}%`,n.style.transform="scale(1.75)"}),document.addEventListener("touchmove",r=>{if(!e)return;r.preventDefault();const c=e.querySelector("img"),d=r.touches?r.touches[0].clientX:r.clientX,m=r.touches?r.touches[0].clientY:r.clientY;n=a+(d-t)/1.75,s=o+(m-i)/1.75;const p=.4*e.clientWidth,u=.4*e.clientHeight;n=Math.max(-p,Math.min(n,p)),s=Math.max(-u,Math.min(s,u)),l(c)},{passive:!1}),document.addEventListener("mouseup",c),document.addEventListener("touchend",c),document.addEventListener("click",c=>{const d=c.target.closest(".zoom-frame, .row-media.article-mode");if(d&&!c.target.closest(".stl-controls")&&!d.querySelector(".embed-wrapper.stl"))if(d.classList.toggle("zoomed"),d.classList.contains("zoomed")){const c=d.querySelector("img");c&&((e,t)=>{"lens"===t?(e.style.transform="scale(1.75)",e.style.transformOrigin="center center"):(n=0,s=0,e.style.transformOrigin="center center",e.style.transform="scale(1.75) translate(0px, 0px)")})(c,"lens"),d.ontouchstart=c=>((c,d)=>{const m=d.querySelector("img");if(!m)return;r=!0,e=d;const p=c.touches?c.touches[0].clientX:c.clientX,u=c.touches?c.touches[0].clientY:c.clientY;t=p,i=u,a=n,o=s,m.style.transition="none",m.style.transformOrigin="center center",l(m)})(c,d)}else{d.ontouchstart=null;const e=d.querySelector("img");e&&(e.style.transform="")}})}function renderNavigation(e){const t=document.getElementById("nav-stack"),i=document.getElementById("main-header"),n=e&&"Home"!==e?e.split("/"):[];n.length>=3?i.classList.add("deep-nav"):i.classList.remove("deep-nav");const s=n.length+1,a=[];for(let e=1;e<=s;e++){const i=1===e?null:n.slice(0,e-1).join("/"),s=n.length>=e?n[e-1]:null;let o=[];if(o=1===e?[...new Set([...db.filter(e=>e.Page&&"Footer"!==e.Page&&"Home"!==e.Page).map(e=>e.Page.split("/")[0]).filter(e=>e),quotesDb.length>0?"Personal":null].filter(e=>e))].sort():[...new Set(db.filter(e=>e.Page&&e.Page.startsWith(i+"/")).map(t=>t.Page.split("/")[e-1]).filter(e=>e))].sort(),0===o.length)break;const r=`nav-row-${e}`;a.push(r);let l=document.getElementById(r);const c=!l;c&&(l=document.createElement("nav"),l.id=r,l.className="nav-row level-"+(e>1?"n":"1"),s||(l.scrollLeft=50),t.appendChild(l));let d="";const m=i?i+"/":"";o.forEach(t=>{d+=`<a href="#${m+t}" class="${1===e?"nav-link":"sub-link"} fill-anim ${t===s?"active":""}" onclick="closeSearch()">${safeHTML(t)}</a>`}),l.innerHTML!==d&&(l.innerHTML=d),centerNavRow(l,c&&!s)}t.querySelectorAll(".nav-row").forEach(e=>{a.includes(e.id)||e.remove()}),updatePadding()}function centerNavRow(e,t){if(!e)return;if(e.scrollWidth<=e.clientWidth+5)return;const i=e.querySelector(".active");if(i){const t=i.offsetLeft+i.offsetWidth/2-e.clientWidth/2;e.scrollTo({left:t,behavior:"smooth"})}else if(t)requestAnimationFrame(()=>{const t=(e.scrollWidth-e.clientWidth)/2;e.scrollTo({left:t,behavior:"smooth"})});else{const t=(e.scrollWidth-e.clientWidth)/2;e.scrollTo({left:t,behavior:"smooth"})}}let resizeTimer;function updatePadding(){const e=document.getElementById("nav-stack").querySelectorAll(".nav-row");let t=37;e.forEach(e=>{const i=e.classList.contains("level-1")?26:24;t+=i+1}),document.body.style.paddingTop=t+10+"px"}function resetToHome(){closeSearch(),window.location.hash=""}function closeSearch(){document.getElementById("search-overlay").classList.remove("active"),document.body.classList.remove("search-active");const e=document.getElementById("search-input"),t=""!==e.value;e.value="",e.blur(),isSearchActive&&t&&(isSearchActive=!1,handleRouting()),isSearchActive=!1}function toggleSearch(){const e=document.getElementById("search-overlay").classList.toggle("active");document.body.classList.toggle("search-active"),e?setTimeout(()=>document.getElementById("search-input").focus(),100):closeSearch()}function handleSearch(e){if(!document.getElementById("search-overlay").classList.contains("active"))return;if(!e)return isSearchActive=!1,void handleRouting();isSearchActive=!0;const t=e.toLowerCase();let i=db.filter(e=>e.Title&&e.Title.toLowerCase().includes(t)||e.Content&&e.Content.toLowerCase().includes(t)||e.Tags&&e.Tags.toLowerCase().includes(t));if(resumeDb.some(e=>e.Title&&e.Title.toLowerCase().includes(t)||e.Content&&e.Content.toLowerCase().includes(t)||e.Tags&&e.Tags.toLowerCase().includes(t))){const e=db.find(e=>"Professional/Resume"===e.Page);e&&!i.includes(e)&&i.push(e)}renderRows(i,`Search results for "${safeHTML(e)}"`,!1,!0,!1,!0)}function handleRouting(){if(isSearchActive)return;cleanup3DResources();const e=document.getElementById("main-header");e&&e.classList.remove("scrolled"),window.scrollTo(0,0);let t=window.location.hash.substring(1)||"Home";if("Index"!==t)if("Professional/Resume"!==t){if("professional/resumec"===t.toLowerCase())return CONFIG.resume_sheet!==CONFIG.custom_resume_sheet?(CONFIG.resume_sheet=CONFIG.custom_resume_sheet,document.getElementById("app").innerHTML='<div class="sk-container"><div class="sk-box hero"></div></div>',void fetchDataAndCache().then(()=>renderResume())):void renderResume();renderNavigation("Home"===t?null:t),t.startsWith("Filter:")?renderFiltered(decodeURIComponent(t.split(":")[1])):renderPage(t)}else renderResume();else renderIndex()}function renderFiltered(e){const t=e.match(/^(\d{4})-(\d{2})(-\d{2})?$/),i=e.match(/^(\d{4})(\d{2})/);let n=e;if(t){n=`${new Date(t[1],parseInt(t[2])-1,1).toLocaleString("default",{month:"short"}).toUpperCase()} ${t[1]}`}else if(i){n=`${new Date(i[1],parseInt(i[2])-1,1).toLocaleString("default",{month:"short"}).toUpperCase()} ${i[1]}`}renderRows(db.filter(t=>(t.Timestamp||"").startsWith(e)||t.Tags&&t.Tags.includes(e)),`Posts from ${safeHTML(n)}`,!1,!0,!1,!0)}function renderPage(e){if("Home"===e)return void renderHome();const t=db.filter(t=>t.Page===e),i=document.getElementById("app");i.innerHTML="";const n=!e.includes("/");if(t.length>0)renderRows(t,null,!0,!1,!n);else if(!childrenPagesCheck(e)&&!("Personal"===e&&quotesDb.length>0))return void(i.innerHTML='<div class="layout-404"><h1>404</h1><h2>Data Not Found</h2><p>This page doesn\'t exist in the database yet.</p><a href="#" class="btn-primary" onclick="resetToHome()">Go Home</a></div>');if("Personal"===e&&quotesDb.length>0){const q=document.createElement("div");q.className="layout-quote section";q.setAttribute("data-title","Random Quote");renderQuoteCard(q);i.appendChild(q)}if(n){const t=[...new Set(db.filter(t=>t.Page&&t.Page.startsWith(e+"/")).map(e=>e.Page))];if(t.length>0){renderRows(t.map(e=>db.find(t=>t.Page===e)).filter(e=>e),null,!0,!0)}}}function childrenPagesCheck(e){return[...new Set(db.filter(t=>t.Page&&t.Page.startsWith(e+"/")).map(e=>e.Page))].length>0}function renderIndex(){renderNavigation(null);const e=document.getElementById("app");e.innerHTML='<div class="section layout-hero"><h1 class="fill-anim">Index</h1></div><div class="section index-list"></div>';const t=e.querySelector(".index-list"),i=[...new Set(db.map(e=>e.Page).filter(e=>e&&"Home"!==e&&"Footer"!==e))].sort(),n={};i.forEach(e=>{const t=e.split("/")[0];n[t]||(n[t]=[]),n[t].push(e)});for(const[e,i]of Object.entries(n)){let n="";const s=e.toLowerCase();"projects"===s?n="cat-projects":"professional"===s?n="cat-professional":"personal"===s&&(n="cat-personal");let a=`<div class="index-group ${n}"><h3>${e}</h3>`;i.forEach(e=>{const t=db.find(t=>t.Page===e),i=t?t.Title:e.split("/").pop(),n=e.split("/").length;a+=`<a href="#${e}" class="index-link fill-anim ${n>1?`depth-${n}`:""}">\n                                ${i} \n                             </a>`}),a+="</div>",t.innerHTML+=a}}function renderHome(){const e=db.filter(e=>"Home"===e.Page);document.getElementById("app").innerHTML="",renderRows(e,null,!0);const t=db.filter(e=>e.Page&&"Home"!==e.Page&&"Footer"!==e.Page),i={};t.forEach(e=>{if(i[e.Page]){i[e.Page]}else i[e.Page]=e});const n=Object.values(i).sort((e,t)=>new Date(t.Timestamp||0)-new Date(e.Timestamp||0)).slice(0,6);n.length>0&&renderRows(n,"Recent Activity",!0,!0,!1,!0)}function processText(e,t){if(!e)return"";const i=e.split(/\n|<br>/);let n=[],s=!1,a={type:"",title:"",collapse:null,lines:[]},o=!1,r="",l=[],c=!1,d=[],m=!1,p=[];const u=()=>{if(!s)return;const e=a.type,i=a.lines.join("\n"),o=a.lines.map(e=>e.trim()).filter(e=>e);if(e.startsWith("button")||e.startsWith("btn")){const t=o[0]||"#",i=e.replace(/^(button|btn)[-:]?/,"").toLowerCase(),r=i?" "+i:"";return n.push(`<a href="${t}" class="btn-pill${r}" target="_blank">${safeHTML(a.title)}</a>`),s=!1,void(a={type:"",title:"",collapse:null,lines:[]})}if("model"===e||"3d"===e||"stl"===e){const e=o[0],t=o[1]?`data-color="${o[1]}"`:"";return e&&n.push(`<div class="embed-wrapper stl" data-src="${e}" ${t}></div>`),s=!1,void(a={type:"",title:"",collapse:null,lines:[]})}if("stat"===e||"statistic"===e){const e=a.title,t=o.join(" ");return n.push(`<div class="stat-block"><div class="stat-number">${processSingleLine(e)}</div><div class="stat-label">${processSingleLine(t)}</div></div>`),s=!1,void(a={type:"",title:"",collapse:null,lines:[]})}if("compare"===e||"comparison"===e){const e=/!\[.*?\]\((.*?)\)|(https?:\/\/\S+\.(?:jpg|jpeg|png|gif|webp))/gi;let t=[...i.matchAll(e)].map(e=>e[1]||e[2]).filter(e=>e);if(t.length<2&&o.length>=2&&(t=[o[0],o[1]]),t.length>=2)return n.push(`\n                            <div class="compare-container">\n                                <img src="${t[1].trim()}" class="compare-img compare-after">\n                                <img src="${t[0].trim()}" class="compare-img">\n                                <div class="compare-handle"></div>\n                                <input type="range" min="0" max="100" value="50" class="compare-slider" oninput="this.parentElement.style.setProperty('--pos', this.value + '%')">\n                            </div>`),s=!1,void(a={type:"",title:"",collapse:null,lines:[]})}if("gallery"===e||"grid"===e){const e=/!\[.*?\]\((.*?)\)|(https?:\/\/\S+\.(?:jpg|jpeg|png|gif|webp))/gi,t=[...i.matchAll(e)].map(e=>e[1]||e[2]).filter(e=>e);if(t.length>0){const e=t.map(e=>`<div class="zoom-frame"><img src="${e}" loading="lazy" alt="Gallery"></div>`).join("");return n.push(`<div class="inline-gallery">${e}</div>`),s=!1,void(a={type:"",title:"",collapse:null,lines:[]})}}if("timeline"===e){let e="",i="",o="";const r=()=>{(i||o)&&(e+=`<div class="timeline-item"><div class="timeline-date">${i}</div><div class="timeline-content">${processText(o,t)}</div></div>`)};return a.lines.forEach(e=>{const t=e.replace(/^[->\s*]+/,"").trim();if(!t)return;const n=t.split(/ - | ï¿½ /);n.length>=2?(r(),i=n[0].trim(),o=n.slice(1).join(" - ").trim()):o?o+="<br>"+t:o=t}),r(),e&&n.push(`<div class="timeline-block">${e}</div>`),s=!1,void(a={type:"",title:"",collapse:null,lines:[]})}if("toc"===e||"tableofcontents"===e)return n.push('<div class="toc-placeholder"></div>'),s=!1,void(a={type:"",title:"",collapse:null,lines:[]});if("chart"===e){let e="bar",t="",o="",r=a.title||"";if(i.split("\n").forEach(i=>{const n=i.trim();n.toLowerCase().startsWith("type:")?e=n.substring(5).trim():n.toLowerCase().startsWith("labels:")?t=n.substring(7).trim():n.toLowerCase().startsWith("data:")||n.toLowerCase().startsWith("values:")?o=n.substring(n.indexOf(":")+1).trim():n.toLowerCase().startsWith("title:")&&(r=n.substring(6).trim())}),t=t.replace(/,\s*/g,"||"),o=o.replace(/,\s*/g,"||"),o){const i=`chart-${Math.random().toString(36).substr(2,9)}`;return n.push(`\n                            <div class="chart-wrapper" style="position:relative; height:300px; width:100%; max-width:600px; margin:20px auto;">\n                                <canvas id="${i}" class="smart-chart" \n                                    data-type="${e}" \n                                    data-labels="${t}" \n                                    data-values="${o}" \n                                    data-title="${r}">\n                                </canvas>\n                            </div>\n                        `),s=!1,void(a={type:"",title:"",collapse:null,lines:[]})}}const r=getCalloutIcon(a.type);a.lines.join("\n");let l=processLineArray(a.lines,t);const c="note"===a.type||"tip"===a.type?"h4":"h5",d=a.title?`<span class="callout-title-text">${processSingleLine(a.title,t)}</span>`:`<span class="callout-title-text">${a.type.toUpperCase()}</span>`,m=a.collapse?"onclick=\"this.classList.toggle('collapsed')\"":"",p="-"===a.collapse?"collapsed":"";n.push(`\n                    <div class="callout ${a.type} ${p}" ${m} data-callout="${a.type}">\n                        <${c} class="callout-title">\n                            <div class="callout-icon"><svg viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round">${r}</svg></div>\n                            <div class="callout-title-inner">${d}</div>\n                        </${c}>\n                        <div class="callout-content">${l}</div>\n                    </div>\n                `),s=!1,a={type:"",title:"",collapse:null,lines:[]}},h=()=>{if(o){if("mermaid"===r){const e=l.join("\n").replace(/</g,"&lt;").replace(/>/g,"&gt;");n.push(`<div class="mermaid">${e}</div>`)}else{const e=l.join("\n").replace(/</g,"&lt;").replace(/>/g,"&gt;");n.push(`<pre><code class="${r}">${e}</code></pre>`)}o=!1,l=[],r=""}},g=()=>{if(!c)return;const e=d.join("\n").trim();n.push(`$$ ${e} $$`),c=!1,d=[]},f=()=>{if(!m)return;let e="",i=[];for(p.forEach(n=>{const s=n.match(/^(\s*)-\s+(.*)/);if(!s)return;const a=s[1].length,o=processSingleLine(s[2].trim(),t);if(0===i.length)e+="<ul>",i.push(a);else{const t=i[i.length-1];if(a>t)e+="<ul>",i.push(a);else if(a<t)for(;i.length>0&&i[i.length-1]>a;)e+="</ul>",i.pop()}e+=`<li>${o}</li>`});i.length>0;)e+="</ul>",i.pop();n.push(e),m=!1,p=[]};let v=[];function y(){v.length>0&&(n.push(`<p>${v.join(" ")}</p>`),v=[])}for(let e=0;e<i.length;e++){let b=i[e].trimEnd();if(""===b.trim()){y();continue}if(b.trim().startsWith("#")||"---"===b.trim()||"$$"===b.trim()||b.trim().startsWith("```")||b.match(/^(\s*)-\s+(.*)/)&&!b.trim().startsWith("- [")||b.trim().startsWith("[chart:")||b.trim().startsWith("[compare:")||b.trim().startsWith("|")&&e+1<i.length&&i[e+1].trim().startsWith("|")||b.trim().startsWith(">")&&b.match(/^>\s*\[!/)){if(y(),"$$"===b.trim()){c?g():(s&&u(),c=!0);continue}if(c){d.push(b);continue}if(b.trim().startsWith("```")){o?h():(s&&u(),o=!0,r=b.trim().substring(3).trim().toLowerCase());continue}if(o){l.push(b);continue}if(b.trim().startsWith("[chart:")){const e=b.trim().substring(7,b.trim().length-1).split(":");if(e.length>=3){const t=e[0],i=e[1].replace(/,/g,"||"),s=e[2].replace(/,/g,"||"),a=e[3]||"",o=`chart-${Math.random().toString(36).substr(2,9)}`;n.push(`\n                                <div class="chart-wrapper" style="position:relative; height:300px; width:100%; max-width:600px; margin:20px auto;">\n                                    <canvas id="${o}" class="smart-chart" \n                                        data-type="${t}" \n                                        data-labels="${i}" \n                                        data-values="${s}" \n                                        data-title="${a}">\n                                    </canvas>\n                                </div>\n                            `);continue}}if(b.trim().startsWith("[compare:")){const e=b.trim().substring(9,b.trim().length-1).split(/:(?=http)/);if(e.length>=2){n.push(`\n                        <div class="flex-center-wrapper">\n                            <div class="compare-container" style="--pos:50%">\n                                <img src="${e[0].trim()}" class="compare-img">\n                                <img src="${e[1].trim()}" class="compare-img compare-after">\n                                <div class="compare-handle"></div>\n                                <input type="range" min="0" max="100" value="50" class="compare-slider" oninput="this.parentElement.style.setProperty('--pos', this.value + '%')">\n                            </div>\n                        </div>`);continue}}if(b.trim().startsWith("|")&&e+1<i.length){if(i[e+1].trim().match(/^\|?[\s-:\\|]+\|?$/)){s&&u();let a=[];for(;e<i.length&&i[e].trim().startsWith("|");)a.push(i[e].trim()),e++;e--;let o='<div class="table-wrapper"><div class="copy-table-btn" onclick="copyTable(this)">Copy CSV</div><table>';o+=`<thead><tr>${a[0].split("|").filter(e=>""!==e.trim()).map(e=>`<th>${e.trim()}</th>`).join("")}</tr></thead><tbody>`;for(let e=2;e<a.length;e++){const i=a[e].split("|");a[e].trim().startsWith("|")&&i.shift(),a[e].trim().endsWith("|")&&i.pop(),o+=`<tr>${i.map(e=>`<td>${processSingleLine(e.trim(),t)}</td>`).join("")}</tr>`}o+="</tbody></table></div>",n.push(o);continue}}const v=b.trim().match(/^(#{1,6})\s+(.*)$/);if(v){s&&u(),o&&h(),c&&g(),m&&f();const e=v[1].length,i=v[2];n.push(`<h${e} class="fill-anim">${processSingleLine(i,t)}</h${e}>`);continue}if(b.match(/^(\s*)-\s+(.*)/)){s&&u(),m=!0,p.push(b);continue}if("---"===b.trim()){n.push("<hr>");continue}const w=b.trim().match(/^>\s*\[!([\w-:]+)\]([-+]?)\s*(.*)$/);if(w){s&&u(),s=!0,a.type=w[1].toLowerCase(),a.collapse=w[2]||null,a.title=w[3].trim();continue}}if(c)d.push(b);else if(o)l.push(b);else{if(m){if(b.match(/^(\s*)-\s+(.*)/)||""!==b.trim()&&b.match(/^\s+/)){p.push(b);continue}f()}if(s){if(b.trim().startsWith(">")){a.lines.push(b.trim().replace(/^>\s?/,""));continue}if((a.type.startsWith("btn")||a.type.startsWith("button"))&&0===a.lines.length&&b.trim()){a.lines.push(b.trim());continue}b.trim(),u()}c||o||m||s||v.push(processSingleLine(b.trim(),t))}}return v.length>0&&y(),s&&u(),o&&h(),c&&g(),m&&f(),n.join("")}function processLineArray(e,t){return e.map(e=>processSingleLine(e,t)).join("<br>")}function processSingleLine(e,t){if(!e)return"";let i=[];if(e=e.replace(/(\$\$[\s\S]*?\$\$)|(\\\([\s\S]*?\\\))|(\$[^$\n]+\$)/g,e=>(i.push(e),`__MATH_${i.length-1}__`)),t&&t.forEach(t=>{t&&(e=e.replace(t,""))}),e.match(/^\[(.*?)\]$/)||e.match(/^https?:\/\/.*,.*https?:\/\//)){const t=e.startsWith("[")?e.substring(1,e.length-1):e;if(!t.includes("](")){const e=t.split(",").map(e=>e.trim());if(e.every(e=>e.startsWith("http")||e.startsWith("{{"))){return`<div class="auto-grid">${e.map(e=>{const t=detectEmbed(e);return t.startsWith("<a href")||e.match(/\.(jpeg|jpg|gif|png|webp|svg)$/i)?`<div class="zoom-frame"><img src="${e}" loading="lazy" alt="Grid Image"></div>`:t}).join("")}</div>`}}}if(e.match(/^https?:\/\/\S+$/)){if(e.includes("youtube")||e.includes("youtu.be")||e.includes("twitter")||e.includes("x.com")||e.includes("google.com/maps")||e.includes("docs.google.com")||e.includes("desmos.com/calculator")||e.match(/\.(pdf|stl|glb|gltf)$/i))return detectEmbed(e);if(e.match(/\.(jpeg|jpg|gif|png|webp|svg)$/i))return`<div class="zoom-frame"><img src="${e}" loading="lazy" alt="Image"></div>`}let n=safeHTML(e);return n=n.replace(/!\[(.*?)\]\((.*?) "(.*?)"\)/g,(e,i,n,s)=>{const a=`<div class="caption">${processSingleLine(s,t)}</div>`;return n.match(/\.(mp4|webm)$/i)?`<div class="media-group"><div class="zoom-frame"><video src="${n}" controls preload="metadata"></video></div>${a}</div>`:`<div class="media-group"><div class="zoom-frame"><img src="${n}" loading="lazy" alt="${i}"></div>${a}</div>`}),n=n.replace(/!\[(.*?)\]\((.*?)\)/g,(e,t,i)=>i.match(/\.(mp4|webm)$/i)?`<div class="zoom-frame"><video src="${i}" controls preload="metadata"></video></div>`:`<div class="zoom-frame"><img src="${i}" loading="lazy" alt="${t}"></div>`),n=n.replace(/\[(.*?)\]\((.*?)\)/g,'<a href="$2" target="_blank">$1</a>'),n=n.replace(/\*\*\*(.*?)\*\*\*/g,"<strong><em>$1</em></strong>"),n=n.replace(/\*\*(.*?)\*\*/g,"<strong>$1</strong>"),n=n.replace(/\*(.*?)\*/g,"<em>$1</em>"),n=n.replace(/`(.*?)`/g,"<code>$1</code>"),n=n.replace(/~~(.*?)~~/g,"<del>$1</del>"),n=n.replace(/\^(.*?)\^/g,"<sup>$1</sup>"),n=n.replace(/~(.*?)~/g,"<sub>$1</sub>"),n=n.replace(/==(.*?)==/g,"<mark>$1</mark>"),n=n.replace(/^- \[ \] (.*)/,'<label class="task-item"><input type="checkbox" disabled> $1</label>'),n=n.replace(/^- \[x\] (.*)/,'<label class="task-item checked"><input type="checkbox" checked disabled> $1</label>'),n=n.replace(/\[\s*(https?:\/\/[^\]]+)\s*\]/gi,(e,t)=>{const i=t.split(",").map(e=>e.trim());if(i.every(e=>e.toLowerCase().startsWith("http"))){return`<div class="inline-gallery">${i.map(e=>`<div class="zoom-frame"><img src="${e}" loading="lazy" alt="Gallery"></div>`).join("")}</div>`}return e}),n=n.replace(/\{\{TIMELINE:\s*(.*?)\}\}/gi,(e,t)=>`<div class="timeline-block">${t.split("|").map(e=>{const t=e.split("-");return`<div class="timeline-item"><div class="timeline-date">${t[0]?t[0].trim():""}</div><div class="timeline-content">${t.slice(1).join("-").trim()}</div></div>`}).join("")}</div>`),n=n.replace(/\{\{YOUTUBE:\s*(.*?)\}\}/g,'<div class="embed-wrapper video"><iframe src="$1" allowfullscreen></iframe></div>'),n=n.replace(/\{\{EMBED:\s*(.*?)\}\}/g,'<div class="embed-wrapper"><iframe src="$1"></iframe></div>'),n=n.replace(/\{\{ROW:\s*(.*?)\}\}/gi,(e,t)=>`<div class="btn-container" style="justify-content: flex-start; margin: 10px 0;">${t.split("|").map(e=>processSingleLine(e.trim(),[])).join("")}</div>`),n=n.replace(/\[([^\]]+)\]\(([^)]+)\)/g,'<a href="$2" target="_blank" rel="noopener">$1</a>'),n=n.replace(/(?<!href="|src="|">)(https?:\/\/[^\s<]+)/g,'<a href="$1" target="_blank" rel="noopener" class="fill-anim">$1</a>'),n=n.replace(/\[\[(.*?)\]\]/g,'<a href="#$1" class="wiki-link fill-anim">$1</a>'),n=n.replace(/<a /g,'<a class="fill-anim" '),i.forEach((e,t)=>{n=n.replace(`__MATH_${t}__`,()=>e)}),n}function formatTitle(e,t){if(!e)return"";const i=e.match(/^(#{1,6})\s+(.*)$/);let n=t,s=e;return i&&(n="h"+i[1].length,s=i[2]),`<${n} class="fill-anim">${processSingleLine(s)}</${n}>`}function renderRows(e,t,i,n,s=!1,a=!1){const o=document.getElementById("app");if(!o)return;if(a&&(e.sort((e,t)=>new Date(t.Timestamp||0)-new Date(e.Timestamp||0)),"Recent Activity"===t&&e.sort((e,t)=>{const i=e.Tags&&e.Tags.toLowerCase().includes("featured")?1:0;return(t.Tags&&t.Tags.toLowerCase().includes("featured")?1:0)-i})),i?t&&(o.innerHTML+=`<h2 class="fill-anim" style="display:block; text-align:center; margin-bottom:20px; font-weight:600; font-size:24px; --text-base:#888; --text-hover:#fff;">${t}</h2>`):o.innerHTML=t?`<h2 class="fill-anim" style="display:block; text-align:center; margin-bottom:20px; font-weight:600; font-size:24px; --text-base:#888; --text-hover:#fff;">${t}</h2>`:"",0===e.length&&!i)return void(o.innerHTML+='<div class="layout-404"><h2>Nothing Found</h2><p>No entries match your query.</p></div>');let r=o.querySelector(".grid-container");if(i)r=document.createElement("div"),r.className="grid-container section",o.appendChild(r);else{(n||e.some(e=>!e.SectionType||"quote"!==e.SectionType&&"hero"!==e.SectionType&&"text"!==e.SectionType)&&!s)&&!r&&(r=document.createElement("div"),r.className="grid-container section",o.appendChild(r))}e.forEach((e,t)=>{if(!e.Page||"Footer"===e.Page)return;const i=e=>{const t=e.match(/^\[(.*?)\]\((.*?)\)$/);if(t){const e=t[1],i=t[2];if(/maps\.app\.goo\.gl|google\.com\/maps/i.test(i)){return`<a href="${i}" target="_blank" class="chip location" onclick="event.stopPropagation()">${'<svg class="chip-icon" viewBox="0 0 24 24"><path d="M12 2C8.13 2 5 5.13 5 9c0 5.25 7 13 7 13s7-7.75 7-13c0-3.87-3.13-7-7-7zm0 9.5c-1.38 0-2.5-1.12-2.5-2.5s1.12-2.5 2.5-2.5 2.5 1.12 2.5 2.5-1.12 2.5-2.5 2.5z"/></svg>'}${safeHTML(e)}</a>`}return`<a href="${i}" target="_blank" class="chip location link" onclick="event.stopPropagation()">${'<svg class="chip-icon" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><path d="M18 13v6a2 2 0 0 1-2 2H5a2 2 0 0 1-2-2V8a2 2 0 0 1 2-2h6"/><polyline points="15 3 21 3 21 9"/><line x1="10" y1="14" x2="21" y2="3"/></svg>'}${safeHTML(e)}</a>`}return`<span class="chip" data-tag="${e}">${safeHTML(e)}</span>`};let a=e.Media,l=e.Content||"",c="",d=[],m=safeHTML(e.Title),p=!1;const u=e.Title?e.Title.match(/^https?:\/\/\S+$/):null;if(u){if(d.push(u[0]),p=!0,!a){const t=extractMediaFromContent(e.Title);t&&("img"===t.type?c=`<div class="row-media"><img src="${t.url}" loading="lazy"></div>`:"yt"===t.type?c=`<div class="embed-wrapper video"><iframe src="https://www.youtube-nocookie.com/embed/${t.id}?modestbranding=1&rel=0&origin=${window.location.origin}" title="YouTube video player" frameborder="0" allow="accelerometer; autoplay; clipboard-write; encrypted-media; gyroscope; picture-in-picture; web-share" referrerpolicy="strict-origin-when-cross-origin" allowfullscreen></iframe></div>`:"stl"===t.type&&(c=`<div class="row-media"><div class="embed-wrapper stl" data-src="${t.url}"></div></div>`),a="title-embed")}}else m=e.Title;const h=l.match(/\{\{(?:3D|STL):\s*(.*?)(?:\s*\|\s*(.*?))?\}\}/i);if(h&&!c){c=`<div class="row-media"><div class="embed-wrapper stl" data-src="${h[1].trim()}" ${h[2]?`data-color="${h[2].trim()}"`:""}></div></div>`,l=l.replace(h[0],"")}else if(a||c){if(!c&&"title-embed"!==a){const e=getThumbnail(a);e&&(c=`<div class="row-media"><img src="${e}" loading="lazy"></div>`)}}else{const e=extractMediaFromContent(l);e?(d.push(e.url),"img"===e.type?c=`<div class="row-media"><img src="${e.url}" loading="lazy"></div>`:"yt"===e.type?c=!s||n?`<div class="row-media"><img src="https://img.youtube.com/vi/${e.id}/mqdefault.jpg" loading="lazy"></div>`:`<div class="embed-wrapper video"><iframe src="https://www.youtube-nocookie.com/embed/${e.id}?modestbranding=1&rel=0&origin=${window.location.origin}" title="YouTube video player" frameborder="0" allow="accelerometer; autoplay; clipboard-write; encrypted-media; gyroscope; picture-in-picture; web-share" referrerpolicy="strict-origin-when-cross-origin" allowfullscreen></iframe></div>`:"stl"===e.type&&(c=`<div class="row-media"><div class="embed-wrapper stl" data-src="${e.url}"></div></div>`)):c=`<div class="row-media placeholder"><span>${processSingleLine(m)}</span></div>`}let g=processText(l,d);if(!s||n){const e=document.createElement("div");e.innerHTML=g;const t=[".callout",".table-wrapper","table",".mermaid","pre",".chart-wrapper","canvas",".smart-chart-wrapper","video",".inline-gallery",".btn-container","hr",".embed-wrapper",".row-media"];e.querySelectorAll(t.join(",")).forEach(e=>e.remove()),g=e.innerHTML,g=`<div class="grid-text-preview">${g}</div>`}let f=!a&&!h&&c.includes("placeholder"),v="";const y=e.Page.toLowerCase();y.startsWith("projects")?v="cat-projects":y.startsWith("professional")?v="cat-professional":y.startsWith("personal")&&(v="cat-personal");const b=(e.SectionType||"card").toLowerCase();if(!n&&s&&"quote"!==b&&"hero"!==b){const n=document.createElement("div");n.className="section layout-text",c=c.includes("embed-wrapper")||c.includes("<img")?c.replace("row-media","row-media article-mode"):"";let s="";if(0===t){if(s='<div class="article-meta-row"><a href="#Personal/About" class="author-link fill-anim">SAHIB VIRDEE</a>',e.LinkURL&&(s+=`<a href="${e.LinkURL}" target="_blank" class="article-link-btn"><svg viewBox="0 0 24 24" style="width:12px;height:12px;"><path d="M18 13v6a2 2 0 0 1-2 2H5a2 2 0 0 1-2-2V8a2 2 0 0 1 2-2h6"></path><polyline points="15 3 21 3 21 9"></polyline><line x1="10" y1="14" x2="21" y2="3"></line></svg></a>`),s+='<div class="article-tags">',e.Timestamp){const t=formatDate(e.Timestamp),i=e.Timestamp.substring(0,7);s+=`<span class="chip date" data-date="${i}" data-val="${t}">${t}</span>`}if(e.Tags){e.Tags.split(",").map(e=>e.trim()).forEach(e=>s+=i(e))}const t=(e.Content||"").trim().split(/\s+/).length,n=Math.ceil(t/200);n>0&&(s+=`<span class="chip" style="opacity:0.6; cursor:default;">${n} min read</span>`),s+="</div></div>"}const a=!p&&m?formatTitle(m,0===t?"h1":"h2"):"";return n.innerHTML=`${c}${a}${s}<div class="article-body">${g}</div>`,void o.appendChild(n)}if(!n){if("quote"===b){const t=document.createElement("div");return t.className="layout-quote section",t.setAttribute("data-title",e.Title||""),"random quote"!==(e.Title||"").toLowerCase()&&(t.setAttribute("data-static-quote",e.Content||e.Quote||""),t.setAttribute("data-static-author",e.Author||"Sahib Virdee")),renderQuoteCard(t),void o.appendChild(t)}if("chart"===b){const t=document.createElement("div");t.className="section layout-chart";let i=(e.Tags||"bar").toLowerCase();i.includes("pie")?i="pie":i.includes("doughnut")?i="doughnut":i.includes("line")&&(i="line");const n=(e.Content||"").split("\n"),s=[],a=[];n.forEach(e=>{const t=e.trim();if(!t)return;const i=t.split(/:(.+)/);i.length>=2&&(s.push(i[0].trim()),a.push(i[1].trim()))});const r=`chart-${Math.random().toString(36).substr(2,9)}`;return t.innerHTML=`\n                            ${safeHTML(e.Title)?`<h2 class="fill-anim" style="text-align:center">${processSingleLine(e.Title)}</h2>`:""}\n                            <div class="chart-wrapper" style="position:relative; height:400px; width:100%; max-width:800px; margin:20px auto;">\n                                <canvas id="${r}" class="smart-chart" data-type="${i}" data-labels="${s.join("||")}" data-values="${a.join("||")}" data-title="${e.Title}"></canvas>\n                            </div>\n                        `,void o.appendChild(t)}if("hero"===b){const t=document.createElement("div");t.className="section layout-hero";const n=e.LinkURL||(e.Page?"#"+e.Page:"");n&&(t.classList.add("clickable-block"),t.classList.add("hero-link"),t.setAttribute("data-link",n),t.setAttribute("data-target",n.startsWith("#")?"":"_blank"));let s="";if(e.Timestamp){let t=formatDate(e.Timestamp),i=e.Timestamp.substring(0,7);s+=`<span class="chip date" data-val="${t}" onclick="event.stopPropagation(); window.location.hash='Filter:${i}'">${t}</span>`}if(e.Tags){e.Tags.split(",").map(e=>e.trim()).forEach(e=>s+=i(e))}const a=s?`<div class="hero-meta">${s}</div>`:"";return t.innerHTML=`${formatTitle(e.Title,"h1")}${a}<p>${processText(e.Content)}</p>`,void o.appendChild(t)}if("text"===b){const t=document.createElement("div");return t.className="section layout-text",t.innerHTML=`${safeHTML(e.Title)?formatTitle(e.Title,"h2"):""}<p>${processText(e.Content)}</p>`,void o.appendChild(t)}}const w=e.LinkURL||"",$=e.Tags?e.Tags.split(",").map(e=>e.trim()):[];let T=w;T||(T=`#${e.Page}`);const L=T.startsWith("#")?"":"_blank";let x="";if(e.Timestamp||$.length>0){if(x='<div class="meta-row">',e.Timestamp){let t=formatDate(e.Timestamp);t||(t=e.Timestamp);let i=e.Timestamp.substring(0,7);x+=`<span class="chip date" data-date="${i}" data-val="${t}">${t}</span>`}$.forEach(e=>x+=i(e)),x+="</div>"}const C=document.createElement("div");C.className=`layout-grid clickable-block ${v} ${f?"has-placeholder":""}`,C.setAttribute("data-link",T),C.setAttribute("data-target",L);let k=m;p&&(k="");let S=formatTitle(k,"h3");p&&(S=""),C.innerHTML=`${c}${S}<p>${g}</p>${x}`,r&&r.appendChild(C)}),setTimeout(init3DViewers,420),setTimeout(runMermaid,50),setTimeout(()=>{"function"==typeof generateTOC&&generateTOC(),"function"==typeof addCopyButtons&&addCopyButtons()},60)}function renderQuoteCard(e){let t,i=!1;if("random quote"===(e.getAttribute("data-title")||"").toLowerCase()){if(0===quotesDb.length)return void(e.innerHTML="Quote sheet empty.");t=quotesDb[Math.floor(Math.random()*quotesDb.length)],i=!0}else t={Quote:e.getAttribute("data-static-quote")||"No content.",Author:e.getAttribute("data-static-author")||"Unknown",Source:null};let n=t.Author||"Unknown";t.Source&&t.Source.startsWith("http")?n=`<a href="${t.Source}" target="_blank" class="fill-anim">${safeHTML(n)}</a>`:t.Source&&(n+=` ï¿½ ${safeHTML(t.Source)}`);const s=safeHTML((t.Quote||"").trim().replace(/^"|"$/g,"")),a=s.length;let o="short";a>230?o="xxl":a>150?o="xl":a>100?o="long":a>50&&(o="medium");let r="";i&&(r='<svg class="dice-icon refresh-btn" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="1.5" stroke-linecap="round" stroke-linejoin="round" data-tooltip="Roll">\n                    <rect x="4" y="4" width="16" height="16" rx="3" ry="3" fill="none" stroke="currentColor"></rect>\n                    <circle cx="12" cy="12" r="1.5" fill="currentColor" stroke="none"></circle>\n                    <circle cx="8" cy="8" r="1.5" fill="currentColor" stroke="none"></circle>\n                    <circle cx="16" cy="16" r="1.5" fill="currentColor" stroke="none"></circle>\n                    <circle cx="16" cy="8" r="1.5" fill="currentColor" stroke="none"></circle>\n                    <circle cx="8" cy="16" r="1.5" fill="currentColor" stroke="none"></circle>\n                 </svg>'),e.innerHTML=`<blockquote class="${o}">"${s}"</blockquote>\n                        <div class="quote-footer"><span class="author"> &mdash; ${n}</span>${r}</div>`}function renderFooter(){const e=document.getElementById("footer-links"),t=db.filter(e=>"Footer"===e.Page||"LinkedIn"===e.Title||"Contact"===e.Title).sort((e,t)=>e.Title.localeCompare(t.Title));e.innerHTML="",e.innerHTML+='<a href="https://cloud.umami.is/share/HK1oWrZklaWWH67d" target="_blank" class="fill-anim">Analytics</a>',t.forEach(t=>{let i=t.LinkURL;"Contact"===t.Title&&(i="mailto:sahibdsv+site@gmail.com"),i&&(e.innerHTML+=`<a href="${i}" target="_blank" class="fill-anim">${safeHTML(t.Title)}</a>`)}),e.innerHTML+='<a href="#Index" class="fill-anim" onclick="closeSearch()">Index</a>';let i=document.getElementById("footer-meta");i||(i=document.createElement("div"),i.id="footer-meta",document.querySelector("footer").appendChild(i));let n=document.getElementById("version-tag");n||(n=document.createElement("div"),n.id="version-tag"),n.parentNode!==i&&i.appendChild(n)}function generateTOC(){document.querySelectorAll(".toc-placeholder").forEach(e=>{const t=e.closest(".section, .layout-text, .layout-grid");if(!t)return;const i=t.querySelectorAll("h1, h2, h3");if(0===i.length)return void e.remove();let n='<div class="toc-container"><div class="toc-header">Table of Contents</div><ul class="toc-list">';i.forEach(e=>{if(e.classList.contains("article-title")||e.closest(".article-meta-row"))return;const t=e.id||`toc-${Math.random().toString(36).substr(2,9)}`;e.id=t;const i=e.tagName.toLowerCase();n+=`<li class="toc-item toc-depth-${"h1"===i?1:"h2"===i?2:3}"><a href="#${t}" class="toc-link" onclick="event.preventDefault(); document.getElementById('${t}').scrollIntoView({behavior:'smooth'})">${e.textContent}</a></li>`}),n+="</ul></div>",e.outerHTML=n})}function addCopyButtons(){document.querySelectorAll("pre").forEach(e=>{if(e.querySelector(".copy-btn"))return;const t=document.createElement("button");t.className="copy-btn",t.textContent="Copy",t.style.cssText="position:absolute; top:8px; right:8px; padding:4px 10px; font-size:11px; background:rgba(255,255,255,0.1); color:#ccc; border:1px solid rgba(255,255,255,0.2); border-radius:4px; cursor:pointer; opacity:0; transition:0.2s; backdrop-filter:blur(4px);",e.style.position="relative",e.onmouseenter=()=>t.style.opacity="1",e.onmouseleave=()=>t.style.opacity="0",t.onclick=()=>{const i=e.querySelector("code")?.innerText||e.innerText;navigator.clipboard.writeText(i).then(()=>{t.textContent="Copied!",t.style.color="#4caf50",t.style.borderColor="#4caf50",setTimeout(()=>{t.textContent="Copy",t.style.color="#ccc",t.style.borderColor="rgba(255,255,255,0.2)"},2e3)})},e.appendChild(t)})}function initCharts(){"undefined"!=typeof Chart&&document.querySelectorAll(".smart-chart:not([data-initialized])").forEach(e=>{e.setAttribute("data-initialized","true");const t=e.getContext("2d"),i=e.getAttribute("data-type"),n=e.getAttribute("data-labels").split("||"),s=e.getAttribute("data-values").split("||").map(Number),a=e.getAttribute("data-title");new Chart(t,{type:i,data:{labels:n,datasets:[{label:"Data",data:s,backgroundColor:["rgba(255, 99, 132, 0.8)","rgba(54, 162, 235, 0.8)","rgba(255, 206, 86, 0.8)","rgba(75, 192, 192, 0.8)","rgba(153, 102, 255, 0.8)","rgba(255, 159, 64, 0.8)"],borderWidth:0}]},options:{responsive:!0,maintainAspectRatio:!1,plugins:{legend:{labels:{color:"#ccc"}},title:{display:!!a,text:a,color:"#fff",font:{size:14}}},scales:"pie"===i||"doughnut"===i?{}:"bar"===i||"line"===i?{y:{ticks:{color:"#888"},grid:{color:"#333"},beginAtZero:!0},x:{ticks:{color:"#888"},grid:{color:"transparent"}}}:{r:{grid:{color:"#333"},ticks:{display:!1}}}}})})}function getThumbnail(e){if(!e)return null;if(e.includes("youtube.com")||e.includes("youtu.be")){let t=e.split("v=")[1];return t&&t.includes("&")&&(t=t.split("&")[0]),!t&&e.includes("youtu.be")&&(t=e.split("/").pop()),`https://img.youtube.com/vi/${t}/mqdefault.jpg`}return e.endsWith(".mp4")?null:e}function formatDate(e){if(!e)return"";if(e instanceof Date){return`${e.getDate()} ${e.toLocaleString("default",{month:"short"}).toUpperCase()} ${e.getFullYear()}`}if(8===(e=String(e).trim()).length&&!isNaN(e)){const t=e.substring(0,4),i=e.substring(4,6),n=e.substring(6,8),s=new Date(t,i-1,n,12,0,0);return`${s.getDate()} ${s.toLocaleString("default",{month:"short"}).toUpperCase()} ${t}`}const t=e.match(/^(\d{4})-(\d{2})-(\d{2})/);if(t){const e=parseInt(t[1]),i=parseInt(t[2]),n=parseInt(t[3]);return`${n} ${new Date(e,i-1,n,12,0,0).toLocaleString("default",{month:"short"}).toUpperCase()} ${e}`}if(e.toLowerCase().includes("present")||isNaN(Date.parse(e)))return e;const i=new Date(e);if(isNaN(i.getTime()))return e;return`${i.getDate()} ${i.toLocaleString("default",{month:"short"}).toUpperCase()} ${i.getFullYear()}`}function runMermaid(){window.mermaid&&(mermaid.initialize({startOnLoad:!1,theme:"dark",gantt:{barHeight:30,fontSize:14,sectionFontSize:14,padding:15,topPadding:60}}),document.querySelectorAll(".mermaid").forEach(e=>mermaid.init(void 0,e)))}function copyTable(e){const t=e.parentElement.querySelector("table");let i=[];t.querySelectorAll("tr").forEach(e=>{const t=[];e.querySelectorAll("td, th").forEach(e=>t.push('"'+e.innerText+'"')),i.push(t.join(","))}),navigator.clipboard.writeText(i.join("\n"));const n=e.innerText;e.innerText="COPIED",setTimeout(()=>e.innerText=n,2e3)}window.addEventListener("resize",()=>{clearTimeout(resizeTimer),resizeTimer=setTimeout(()=>{document.querySelectorAll(".nav-row").forEach(e=>centerNavRow(e,!1)),updatePadding()},100)});let mermaidAPI=null;function initMermaid(){mermaidAPI||import("https://cdn.jsdelivr.net/npm/mermaid@10/dist/mermaid.esm.min.mjs").then(e=>{mermaidAPI=e.default,mermaidAPI.initialize({startOnLoad:!1,theme:"dark"}),document.querySelectorAll(".mermaid").forEach(e=>mermaidAPI.init(void 0,e))})}function updateSEO(){const e=document.getElementById("json-ld-script");e&&e.remove();const t=document.createElement("script");t.id="json-ld-script",t.type="application/ld+json";const i={"@context":"https://schema.org","@type":"ProfilePage",mainEntity:{"@type":"Person",name:"Sahib Virdee",jobTitle:"Mechanical Engineering Graduate",description:"Specializing in Design and Manufacturing.",url:"https://sahibvirdee.com/",sameAs:["https://github.com/sahibdsv","https://www.linkedin.com/in/sahibdsv/"]},hasPart:db.map(e=>{if(!e.Title||!e.Content)return null;return{"@type":e.Page.toLowerCase().includes("project")?"SoftwareSourceCode":"CreativeWork",name:e.Title,description:e.Content.substring(0,150)+"...",url:`https://sahibvirdee.com/#${e.Page}`}}).filter(e=>e)};t.textContent=JSON.stringify(i),document.head.appendChild(t)}function runMermaid(){const e=document.querySelectorAll(".mermaid:not([data-processed])");0!==e.length&&(mermaidAPI?mermaidAPI.run({nodes:[...e]}).catch(console.error):initMermaid())}function renderResume(){renderNavigation("Professional/Resume");document.getElementById("app").innerHTML='<div id="resume-view" class="resume-container"></div>';const e=document.getElementById("resume-view");generateResumeJSONLD();const t=resumeDb,i=t.filter(e=>e.SectionType&&"header"===e.SectionType.toLowerCase());if(i.length>0){const t=i[0],n=t.Title.split("|"),s=n[0].trim(),a=n[1]?n[1].trim():"";e.innerHTML+=`\n                    <div class="resume-header section" style="position:relative;">\n                        <button class="btn-pill" onclick="window.print()" style="position:absolute; right:0; top:0; margin:0; font-size:12px; padding:6px 12px; cursor:pointer;">\n                            Download PDF\n                        </button>\n                        <h1 class="fill-anim" style="margin-top:0;">${s}</h1>\n                        <div class="resume-sub fill-anim" style="animation-delay:0.1s">${a}</div>\n                        <div class="resume-contact" style="gap:0 !important; row-gap:4px !important;">\n                            ${(t.Content||"").split("|").map(e=>`<span style="white-space:nowrap;">${processText(e.trim())}</span>`).join('<span class="contact-sep" style="margin:0 12px; color:#bbb; user-select:text;">|</span>')}\n                        </div>\n                    </div>`}e.innerHTML+='<div class="resume-grid section">\n                <div class="resume-left"></div>\n                <div class="resume-right"></div>\n            </div>';const n=e.querySelector(".resume-left"),s=e.querySelector(".resume-right"),a={};t.forEach(e=>{if(!e.SectionType)return;const t=e.SectionType.trim().toLowerCase(),i=t.charAt(0).toUpperCase()+t.slice(1);a[i]||(a[i]=[]),a[i].push(e)});const o=(e,t,i,n)=>{i&&i.length>0&&(e.innerHTML+=`<div class="resume-section">\n                        ${formatTitle(t,"h3")}\n                        ${i.map(n).join("")}\n                    </div>`)};o(n,"Education",a.Education,RenderResumeEntry),o(n,"Skills",a.Skills,RenderResumeSkill),o(s,"Professional Experience",a.Experience,RenderResumeEntry),o(s,"Engineering Projects",a.Project,RenderResumeEntry)}function RenderResumeEntry(e){let t=e.Title||"",i="";if(t.includes("|")){const e=t.split("|");t=e[0].trim(),i=e[1].trim()}const n=e.LinkURL?`<a href="${e.LinkURL}" target="_blank" class="resume-link"><svg viewBox="0 0 24 24" style="width:12px;height:12px;display:inline-block;vertical-align:middle;opacity:0.7;"><path d="M18 13v6a2 2 0 0 1-2 2H5a2 2 0 0 1-2-2V8a2 2 0 0 1 2-2h6"></path><polyline points="15 3 21 3 21 9"></polyline><line x1="10" y1="14" x2="21" y2="3"></line></svg></a>`:"";let s=e.Content||"";s.includes("|")&&(s="- "+s.replace(/\|/g,"\n- ")),s=s.replace(/(\n|^)-\s*([^:\n]+?):/g,"$1- **$2:**");const a=processText(s);let o="",r="";if(e.Tags){const t=e=>{if((e=e.trim()).match(/[A-Za-z]{3,}\s+\d{4}/)||e.toLowerCase().includes("present"))return{type:"date",html:safeHTML(e)};const t=e.match(/^\[(.*?)\]\((.*?)\)$/);if(t){const e=t[1],i=t[2];return{type:"loc",html:`<a href="${i}" target="_blank" style="text-decoration:none; color:inherit; display:flex; align-items:center;">${/maps\.app\.goo\.gl|google\.com\/maps/i.test(i)?'<svg class="chip-icon" viewBox="0 0 24 24" style="width:12px; height:12px; margin-right:4px; vertical-align:middle; display:inline-block;"><path d="M12 2C8.13 2 5 5.13 5 9c0 5.25 7 13 7 13s7-7.75 7-13c0-3.87-3.13-7-7-7zm0 9.5c-1.38 0-2.5-1.12-2.5-2.5s1.12-2.5 2.5-2.5 2.5 1.12 2.5 2.5-1.12 2.5-2.5 2.5z"/></svg>':'<svg class="chip-icon" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" style="width:12px; height:12px; margin-right:4px; vertical-align:middle; display:inline-block;"><path d="M18 13v6a2 2 0 0 1-2 2H5a2 2 0 0 1-2-2V8a2 2 0 0 1 2-2h6"/><polyline points="15 3 21 3 21 9"/><line x1="10" y1="14" x2="21" y2="3"/></svg>'}${safeHTML(e)}</a>`}}return{type:"other",html:safeHTML(e)}},i=e.Tags.includes(";")?/(?:;|\u2022)\s*/:/(?:;|,|\u2022)\s*/,n=e.Tags.split(i).filter(e=>e.trim()),s=[];n.forEach(e=>{const i=t(e);"date"!==i.type||o?s.push(i.html):o=i.html}),s.length>0&&(r=s.join(", "))}return`\n            <div class="resume-entry" id="res-${e.ID||Math.random().toString(36).substr(2,9)}">\n                <div class="resume-entry-header">\n                    <div class="resume-row-main" style="display:flex; justify-content:space-between; align-items:baseline;">\n                        <div class="resume-role">${t} ${n}</div>\n                        <div class="resume-date-slot">${o}</div>\n                    </div>\n                    <div class="resume-row-sub" style="display:flex; justify-content:space-between; align-items:baseline;">\n                        ${i?`<div class="resume-company">${i}</div>`:"<div></div>"}\n                        <div class="resume-loc-slot">${r}</div>\n                    </div>\n                </div>\n                <div class="resume-list text-content">${a}</div>\n            </div>`}function RenderResumeSkill(e){const t=(e.Content||"").split("|").map(e=>e.trim()).filter(e=>e);let i="";return t.forEach(e=>{const t=e.indexOf(":");if(t>-1){const n=e.substring(0,t).trim(),s=e.substring(t+1).trim();i+=`<div class="resume-skill-row">\n                        <span class="resume-skill-cat">${n}:</span> \n                        <span class="resume-skill-list">${s}</span>\n                    </div>`}else i+=`<div class="resume-skill-row"><span class="resume-skill-list">${e}</span></div>`}),`\n            <div class="resume-skill-block">\n                ${e.Title&&"Technical Skills"!==e.Title?`<div class="resume-skill-title">${e.Title}</div>`:""}\n                ${i}\n            </div>`}function generateResumeJSONLD(){const e=document.getElementById("json-ld-resume");e&&e.remove();const t=resumeDb,i=t.filter(e=>"Header"===e.SectionType);if(0===i.length)return;const n=i[0],s=n.Title.split("|")[0].trim(),a=n.Title.split("|")[1]?n.Title.split("|")[1].trim():"Engineer",o={"@context":"https://schema.org","@type":"Person",name:s,jobTitle:a,url:"https://sahibvirdee.com/resume",description:`Resume of ${s}, ${a}.`,knowsAbout:t.filter(e=>"Skills"===e.SectionType).map(e=>e.Content).join(", ")},r=document.createElement("script");r.id="json-ld-resume",r.type="application/ld+json",r.textContent=JSON.stringify(o),document.head.appendChild(r)}function detectEmbed(e){const t=(e=e.trim()).match(/(?:https?:\/\/)?(?:www\.)?(?:youtube\.com\/watch\?v=|youtu\.be\/)([\w-]{11})/);return t?`<div class="embed-wrapper video"><iframe src="https://www.youtube-nocookie.com/embed/${t[1]}?modestbranding=1&rel=0&origin=${window.location.origin}" title="YouTube video player" frameborder="0" allow="accelerometer; autoplay; clipboard-write; encrypted-media; gyroscope; picture-in-picture; web-share" referrerpolicy="strict-origin-when-cross-origin" allowfullscreen></iframe></div>`:e.includes("google.com/maps/embed")||e.includes("maps.google.com")?`<div class="embed-wrapper map"><iframe src="${e}"></iframe></div>`:e.includes("google.com/maps/place")?`<div class="embed-wrapper map"><iframe src="${e.replace("/place/","/embed?pb=")}"></iframe></div>`:e.includes("desmos.com/calculator")?`<div class="embed-wrapper doc" style="height:500px"><iframe src="${e}?embed" style="width:100%; height:100%; border:0"></iframe></div>`:e.includes("drive.google.com")?(e.includes("/view")&&(e=e.replace("/view","/preview")),e.includes("/edit")&&(e=e.replace("/edit","/preview")),`<div class="embed-wrapper doc"><iframe src="${e}"></iframe></div>`):e.includes("docs.google.com")&&(e.includes("/spreadsheets/")||e.includes("/document/"))?(e.includes("/edit")&&(e=e.replace("/edit","/preview")),`<div class="embed-wrapper doc"><iframe src="${e}"></iframe></div>`):e.toLowerCase().endsWith(".pdf")?`<div class="embed-wrapper doc"><iframe src="${e}"></iframe></div>`:e.match(/\.(mp3|wav|ogg)$/i)?`<div class="embed-wrapper audio" style="padding:10px;"><audio controls src="${e}" style="width:100%;"></audio></div>`:e.match(/\.(mp4|webm|mov)$/i)?`<div class="embed-wrapper video"><video controls src="${e}" style="width:100%; height:auto;"></video></div>`:e.match(/(?:twitter\.com|x\.com)\/\w+\/status\/\d+/)?`<blockquote class="twitter-tweet" data-theme="dark"><a href="${e}"></a></blockquote>`:e.match(/\.(jpeg|jpg|gif|png|webp|svg)$/i)?`<img src="${e}" class="inline-img zoomable" loading="lazy">`:e.match(/\.(stl|glb|gltf)$/i)?`<div class="embed-wrapper stl" data-src="${e}"></div>`:`<a href="${e}" target="_blank">${e}</a>`}function extractMediaFromContent(e){if(!e)return null;const t=e.match(/https?:\/\/\S+\.(?:jpg|jpeg|png|gif|webp)/i);if(t)return{type:"img",url:t[0]};const i=e.match(/(?:https?:\/\/)?(?:www\.)?(?:youtube\.com\/watch\?v=|youtu\.be\/)([\w-]{11})/);if(i)return{type:"yt",url:i[0],id:i[1]};const n=e.match(/https?:\/\/\S+\.(?:stl|glb|gltf)/i);if(n)return{type:"stl",url:n[0]};const s=e.match(/\{\{(?:3D|STL):\s*(.*?)(?:\s*\|\s*(.*?))?\}\}/i);return s?{type:"stl",url:s[1].trim()}:null}function getCalloutIcon(e){const t={note:'<path d="M14 2H6a2 2 0 0 0-2 2v16a2 2 0 0 0 2 2h12a2 2 0 0 0 2-2V8z"/><polyline points="14 2 14 8 20 8"/><line x1="16" y1="13" x2="8" y2="13"/><line x1="16" y1="17" x2="8" y2="17"/><polyline points="10 9 9 9 8 9"/>',info:'<circle cx="12" cy="12" r="10"/><line x1="12" y1="16" x2="12" y2="12"/><line x1="12" y1="8" x2="12.01" y2="8"/>',todo:'<path d="M12 22c5.523 0 10-4.477 10-10S17.523 2 12 2 2 6.477 2 12s4.477 10 10 10z"/><path d="m9 12 2 2 4-4"/>',tip:'<path d="M8.5 14.5A2.5 2.5 0 0 0 11 12c0-1.38-.5-2-1-3-1.072-2.143-.224-4.054 2-6 .5 2.5 2 4.9 4 6.5 2 1.6 3 3.5 3 5.5a7 7 0 1 1-14 0c0-1.153.433-2.294 1-3a2.5 2.5 0 0 0 2.5 2.5z"/>',success:'<path d="M22 11.08V12a10 10 0 1 1-5.93-9.14"/><polyline points="22 4 12 14.01 9 11.01"/>',question:'<circle cx="12" cy="12" r="10"/><path d="M9.09 9a3 3 0 0 1 5.83 1c0 2-3 3-3 3"/><line x1="12" y1="17" x2="12.01" y2="17"/>',warning:'<path d="M12 2L1 21h22L12 2zm1 14h-2v2h2v-2zm0-6h-2v4h2v-4z"/>',failure:'<circle cx="12" cy="12" r="10"/><line x1="15" y1="9" x2="9" y2="15"/><line x1="9" y1="9" x2="15" y2="15"/>',danger:'<polygon points="7.86 2 16.14 2 22 7.86 22 16.14 16.14 22 7.86 22 2 16.14 2 7.86 7.86 2"/><line x1="15" y1="9" x2="9" y2="15"/><line x1="9" y1="9" x2="15" y2="15"/>',bug:'<rect width="8" height="14" x="8" y="6" rx="4"/><path d="m19 7-3 2"/><path d="m5 7 3 2"/><path d="m19 19-3-2"/><path d="m5 19 3-2"/><path d="M20 13h-4"/><path d="M4 13h4"/><path d="m10 4 1 2"/><path d="m14 4-1 2"/>',example:'<line x1="8" y1="6" x2="21" y2="6"/><line x1="8" y1="12" x2="21" y2="12"/><line x1="8" y1="18" x2="21" y2="18"/><line x1="3" y1="6" x2="3.01" y2="6"/><line x1="3" y1="12" x2="3.01" y2="12"/><line x1="3" y1="18" x2="3.01" y2="18"/>',quote:'<path d="M3 21c3 0 7-1 7-8V5c0-1.25-.756-2.017-2-2H4c-1.25 0-2 .75-2 1.972V11c0 1.25.75 2 2 2 1 0 1 0 1 1v1c0 1-1 2-2 2s-1 .008-1 1.031V20c0 1 0 1 1 1z"/><path d="M15 21c3 0 7-1 7-8V5c0-1.25-.757-2.017-2-2h-4c-1.25 0-2 .75-2 1.972V11c0 1.25.75 2 2 2 1 0 1 0 1 1v1c0 1-1 2-2 2s-1 .008-1 1.031V20c0 1 0 1 1 1z"/>'};return t[{abstract:"note",summary:"note",tldr:"note",hint:"tip",important:"tip",check:"success",done:"success",help:"question",faq:"question",caution:"warning",attention:"warning",fail:"failure",missing:"failure",error:"danger",cite:"quote"}[e]||e]||t.note}document.addEventListener("DOMContentLoaded",()=>{"undefined"==typeof Papa?window.addEventListener("load",init):init()});let active3DContainers=[];function cleanup3DResources(){active3DContainers.forEach(e=>{e.innerHTML="",e.classList.remove("loaded","ready")}),active3DContainers=[]}function init3DViewers(){const e=document.querySelectorAll(".embed-wrapper.stl:not(.loaded)");0!==e.length&&Promise.all([import("three"),import("three/addons/loaders/STLLoader.js"),import("three/addons/loaders/GLTFLoader.js"),import("three/addons/controls/OrbitControls.js")]).then(([t,{STLLoader:i},{GLTFLoader:n},{OrbitControls:s}])=>{const a=new IntersectionObserver(e=>{e.forEach(e=>{const t=e.target;e.isIntersecting?t.setAttribute("data-visible","true"):t.setAttribute("data-visible","false")})}),o=new IntersectionObserver(e=>{e.forEach(e=>{e.isIntersecting&&(loadModel(e.target,t,i,n,s),o.unobserve(e.target),a.observe(e.target))})},{rootMargin:"200px"});e.forEach(e=>{o.observe(e),active3DContainers.push(e)})})}function loadModel(e,t,i,n,s){if(e.classList.contains("loaded"))return;e.classList.add("loaded");const a=e.getAttribute("data-src"),o=e.getAttribute("data-color"),r=a.split(".").pop().toLowerCase(),l=new t.Scene;l.background=null;const c=new t.PerspectiveCamera(30,e.clientWidth/e.clientHeight,.01,1e3),d=new t.WebGLRenderer({alpha:!0,antialias:!0});if(d.setPixelRatio(Math.min(window.devicePixelRatio,2)),d.setSize(e.clientWidth,e.clientHeight),d.outputColorSpace=t.SRGBColorSpace,d.physicallyCorrectLights=!0,e.appendChild(d.domElement),e.closest(".article-mode")){const t=document.createElement("div");t.className="stl-controls",t.innerHTML='\n                    <div class="stl-btn" id="btn-full"><svg viewBox="0 0 24 24"><path d="M7 14H5v5h5v-2H7v-3zm-2-4h2V7h3V5H5v5zm12 7h-3v2h5v-5h-2v3zM14 5v2h3v3h2V5h-5z"/></svg></div>\n                ',e.appendChild(t),setTimeout(()=>{t.classList.add("visible"),setTimeout(()=>t.classList.remove("visible"),2e3)},1e3);const i=()=>{const e=!!document.fullscreenElement?'<path d="M5 16h3v3h2v-5H5v2zm3-8H5v2h5V5H8v3zm6 11h2v-3h3v-2h-5v5zm2-14v3h3v2h-5V5h2z"/>':'<path d="M7 14H5v5h5v-2H7v-3zm-2-4h2V7h3V5H5v5zm12 7h-3v2h5v-5h-2v3zM14 5v2h3v3h2V5h-5z"/>';t.querySelector("#btn-full svg").innerHTML=e};t.querySelector("#btn-full").onclick=()=>{document.fullscreenElement?document.exitFullscreen():e.requestFullscreen().then(()=>{screen.orientation&&screen.orientation.lock&&screen.orientation.lock("landscape").catch(e=>console.log("Orientation lock failed",e))}).catch(e=>{console.log(`Error attempting to enable full-screen mode: ${e.message} (${e.name})`)})},document.addEventListener("fullscreenchange",()=>{i(),setTimeout(w,100),f.enableZoom=!!document.fullscreenElement,f.enableRotate=!!document.fullscreenElement})}const m=new t.AmbientLight(16777215,.6);l.add(m);const p=new t.HemisphereLight(16777215,4473924,.6);p.position.set(0,20,0),l.add(p);const u=new t.DirectionalLight(16777215,1.2);u.position.set(5,10,7),l.add(u);const h=new t.DirectionalLight(16777215,.8);h.position.set(-5,0,-5),l.add(h);const g=new t.DirectionalLight(16777215,.5);g.position.set(0,5,-10),l.add(g);const f=new s(c,d.domElement);let v;f.enableDamping=!1,f.rotateSpeed=.8,f.enablePan=!1,f.autoRotate=!0,f.autoRotateSpeed=2,f.enableZoom=!1,f.enableRotate=!1,f.addEventListener("start",()=>{clearTimeout(v),f.autoRotate=!1}),f.addEventListener("end",()=>{v=setTimeout(()=>{f.autoRotate=!0},5e3)});const y=i=>{e.classList.add("ready");const n=(new t.Box3).setFromObject(i),s=new t.Vector3;n.getCenter(s),i.position.sub(s),l.add(i),o&&i.traverse(e=>{e.isMesh&&(e.material=new t.MeshPhongMaterial({color:o,specular:1118481,shininess:100}))});const a=n.getSize(new t.Vector3).length(),r=a/(2*Math.tan(30*Math.PI/360));c.position.set(r,.4*r,.8*r),c.lookAt(0,0,0),f.minDistance=.2*a,f.maxDistance=5*a,function t(){e.isConnected?(requestAnimationFrame(t),"false"!==e.getAttribute("data-visible")&&(f.update(),d.render(l,c))):d.dispose()}()},b=t=>{console.error(t),e.innerHTML='<div style="color:#666; display:flex; justify-content:center; align-items:center; height:100%; font-size:12px;">Failed to load 3D Model</div>'};if("glb"===r||"gltf"===r){(new n).load(a,e=>y(e.scene),void 0,b)}else{(new i).load(a,e=>{const i=new t.MeshPhongMaterial({color:o||11184810,specular:1118481,shininess:200}),n=new t.Mesh(e,i);y(n)},void 0,b)}const w=()=>{e.isConnected&&(c.aspect=e.clientWidth/e.clientHeight,c.updateProjectionMatrix(),d.setSize(e.clientWidth,e.clientHeight))};window.addEventListener("resize",w)}function initComparisons(){document.querySelectorAll(".compare-slider").forEach(e=>{if(e.addEventListener("input",e=>{e.target.parentElement.style.setProperty("--pos",e.target.value+"%")}),!e.dataset.animated){e.dataset.animated="true";const t=e.parentElement,i=t.querySelectorAll("img");let n=0;const s=i.length,a=()=>{n<s||setTimeout(()=>{let i=0;const n=setInterval(()=>{if(i>30)return clearInterval(n),t.style.setProperty("--pos","50%"),void(e.value=50);const s=i/30,a=50+15*Math.sin(s*Math.PI*2);t.style.setProperty("--pos",a+"%"),e.value=a,i++},25)},500)};i.forEach(e=>{e.complete?n++:e.addEventListener("load",()=>{n++,a()})}),n===s&&a()}})}function loadDemoData(){renderNavigation(null);const e=document.getElementById("app"),t=processText('\n# Feature Demo & Stress Test\n[TOC]\n\nThis page demonstrates the capabilities of the CMS rendering engine including **[Stress Tests](#)** and **[Chaos Checks](#)**.\n\n## 1. Typography & Chaos\nStandard text can be **bold**, *italic*, or [linked](#). \nWe also support [Linked **Bold** Text](#) and [**Bold Linked** Text](#).\nHeck, even `[Code Link](#)` should work?\n\n## 2. Layout Stress (Auto-Grid)\n**5-Column Image Grid:**\n[https://images.unsplash.com/photo-1550745165-9bc0b252726f, https://images.unsplash.com/photo-1549692520-acc6669e2f0c, https://images.unsplash.com/photo-1515694346937-94d85e41e6f0, https://images.unsplash.com/photo-1579546929518-9e396f3cc809, https://images.unsplash.com/photo-1505118380757-91f5f5632de0]\n\n**Mixed Media Grid (Restored):**\n[https://www.google.com/maps/embed?pb=!1m18!1m12!1m3!1d3022.1422937950147!2d-73.9873196845941!3d40.75889497932681!2m3!1f0!2f0!3f0!3m2!1i1024!2i768!4f13.1!3m3!1m2!1s0x89c25855c6480299%3A0x55194ec5a1ae072e!2sTimes+Square!5e0!3m2!1sen!2sus!4v1560412335497!5m2!1sen!2sus, https://www.youtube.com/watch?v=YE7VzlLtp-4, https://images.unsplash.com/photo-1549692520-acc6669e2f0c]\n\n## 3. Deep Tables (With Links)\n| ID | [Link](#) | Status | Description |\n| :--- | :--- | :---: | --- |\n| 001 | [Project A](#) | **Active** | Core infrastructure |\n| 002 | [Project B](#) | *Pending* | Client side API |\n| 003 | [Project C](#) | Delayed | [See Report](#) |\n| 004 | [Project D](#) | Done | Legacy system |\n| 005 | [Project E](#) | **Active** | New features |\n| 006 | [Project F](#) | -- | TBD |\n\n## 4. Callouts & Ordering\n> [!danger] [Critical Error](#)\n> This callout is **Critical** and has a link in the title.\n> It should appear *before* the code block below.\n\n> [!warning] Warning\n> This is a standard warning.\n\n> [!note] Note\n> Just a simple note.\n\n> [!tip] Pro Tip\n> This is a handy tip.\n\n## 5. Code Blocks\n```javascript\n// This block should be below the Critical Error\nfunction testChaos() {\n    return "Complete";\n}\n```\n\n## 6. Mathematics\n**Inline:** $E = mc^2$ inside text.\n**Block (Trim Test):**\n$$\nE = mc^2\n$$\n\n## 7. Diagrams (Mermaid)\n```mermaid\ngraph LR\n    A[Start] --\x3e B{Decision}\n    B --\x3e|Yes| C[Success]\n    B --\x3e|No| D[Failure]\n    click C "#" "Link Test"\n```\n\n## 8. Charts (Variety)\n**Bar Chart:**\n[chart:bar:Q1,Q2,Q3,Q4:120,150,180,220:Annual Growth]\n\n**Doughnut Chart:**\n[chart:doughnut:Direct,Referral,Social:55,30,15:Traffic Source]\n\n## 9. Media & Captions (Overlap Test)\n![Wide Image](https://images.unsplash.com/photo-1472214103451-9374bd1c798e "Standard Caption Test [With Link](#)")\n\n## 10. 3D Models (Scroll Trap Test)\nMobile users should be able to scroll past this without getting trapped.\n{{3D: https://raw.githubusercontent.com/mrdoob/three.js/master/examples/models/stl/binary/pr2_head_pan.stl | #00ff00}}\n\n## 11. Comparison Sliders\nRain vs Clear:\n[compare:https://images.unsplash.com/photo-1515694346937-94d85e41e6f0:https://images.unsplash.com/photo-1500964757637-c85e8a162699]\n');e.innerHTML=`\n        <div class="content-container animate-fade article-mode">\n            ${t}\n        </div>\n    `,setTimeout(()=>{window.Prism&&Prism.highlightAll(),window.MathJax&&MathJax.typeset(),window.mermaid&&mermaid.init(),initCharts(),init3DViewers(),initComparisons(),initImageZoomers()},100)}